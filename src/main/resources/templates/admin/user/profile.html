<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
    <meta charset="UTF-8">
    <title>My profile</title>
</head>
<header th:insert="~{/admin/fragment/header.html::head}">

</header>
<body>
    <div class="container">
        <div class="row">
            <form id="formEdit">
                <div class="form-group">
                    <input type="hidden" class="form-control" name="id" th:value="${profile.getId()}">
                </div>
                <div class="form-group">
                    <label>User Name:</label>
                    <input type="text" class="form-control" name="userName" th:value="${profile.getUserName()}" readonly="readonly">
                </div>
                <div class="form-group">
                    <label>Full name:</label>
                    <input type="text" class="form-control" name="fullName" th:value="${profile.getFullName()}">
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="text" class="form-control" name="email" th:value="${profile.getEmail()}">
                </div>
                <div class="form-group">
                    <button class="btn btn-dark" type="submit">Update</button>
                    <button class="btn btn-dark" type="button" onclick="location.href='/admin/user/profile/password'">Change Password</button>
                </div>
            </form>
        </div>
    </div>
<script>
    $("#formEdit").submit(e=>{
        e.preventDefault();
        console.log($("#formEdit").serializeArray())
        if(confirm("Do you want update profile ???")){
            let data = {};
            $("#formEdit").serializeArray().forEach(item=>{
                data[item.name]=item.value
            })
            console.log(data)
            $.ajax({
                url:"/api/user",
                method:"put",
                data:JSON.stringify(data),
                contentType:"application/json",
                success:res=>{
                    alert("Done!!!")
                    location.reload()
                },
                error:res=>{
                    alert(res.responseJSON.message);
                }
            })
        }
    })
</script>
</body>
</html>